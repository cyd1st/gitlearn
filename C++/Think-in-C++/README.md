Code from Think in cpp 2nd.